# ===================================
# Log Drain Configuration
# ===================================
# Copy relevant sections to your .env.local or Vercel environment variables
# Log drains are automatically enabled in production, or set LOG_DRAIN_ENABLED=true

# === Enable Log Drains in Development ===
LOG_DRAIN_ENABLED=true

# === Datadog Configuration ===
# https://app.datadoghq.com/organization-settings/api-keys
DATADOG_API_KEY=your_datadog_api_key_here
DATADOG_SITE=datadoghq.com  # US: datadoghq.com, EU: datadoghq.eu, US3: us3.datadoghq.com
DATADOG_SERVICE=pebloq
HOSTNAME=vercel-production-1

# === Axiom Configuration ===
# https://app.axiom.co/settings/tokens
AXIOM_TOKEN=xaat-your-axiom-api-token-here
AXIOM_DATASET=pebloq-logs
AXIOM_ORG_ID=your-org-id  # Optional, only for multi-tenant setups

# === Grafana Loki Configuration ===
# Self-hosted or Grafana Cloud: https://grafana.com/products/cloud/
LOKI_URL=https://logs-prod-us-central1.grafana.net
LOKI_USERNAME=your_username  # Optional, for basic auth
LOKI_PASSWORD=your_password  # Optional, for basic auth
LOKI_TENANT=your_tenant_id   # Optional, for multi-tenant Loki

# === Console Log Drain (Development Only) ===
# Outputs structured JSON logs to console for testing
LOG_DRAIN_CONSOLE=true

# ===================================
# Advanced Configuration (Optional)
# ===================================

# Batch Size: Number of logs to buffer before sending (default: 100)
# LOG_DRAIN_BATCH_SIZE=100

# Flush Interval: Milliseconds between automatic flushes (default: 10000)
# LOG_DRAIN_FLUSH_INTERVAL=10000

# Retry Attempts: Number of retries for failed requests (default: 3)
# LOG_DRAIN_RETRY_ATTEMPTS=3

# Retry Delay: Milliseconds between retries (default: 1000)
# LOG_DRAIN_RETRY_DELAY=1000

# ===================================
# Quick Start Examples
# ===================================

# Example 1: Datadog Only (Production)
# DATADOG_API_KEY=abc123...
# DATADOG_SITE=datadoghq.com
# DATADOG_SERVICE=pebloq
# HOSTNAME=vercel-prod

# Example 2: Axiom Only (Serverless-Optimized)
# AXIOM_TOKEN=xaat-xyz789...
# AXIOM_DATASET=pebloq-production

# Example 3: Self-Hosted Loki
# LOKI_URL=http://loki.company.internal:3100

# Example 4: All Three Platforms (Maximum Observability)
# DATADOG_API_KEY=abc...
# AXIOM_TOKEN=xaat...
# LOKI_URL=https://loki...

# ===================================
# Vercel Setup Instructions
# ===================================

# 1. Go to: https://vercel.com/your-team/pebloq/settings/environment-variables
# 2. Add variables for your chosen platform(s)
# 3. Select environments: Production, Preview, Development
# 4. Save and redeploy

# Vercel CLI:
# vercel env add DATADOG_API_KEY production
# vercel env add AXIOM_TOKEN production
# vercel env add LOKI_URL production

# ===================================
# Platform Comparison
# ===================================

# Datadog:
# - Best for: Enterprise, APM, full observability stack
# - Cost: $$$ (~$100/month for 10GB)
# - Features: APM, metrics, traces, logs, dashboards
# - Query Language: Datadog Query Language

# Axiom:
# - Best for: Serverless, high-volume logs, cost-effective
# - Cost: $$ (~$25/month for 10GB)
# - Features: Fast ingestion, SQL-like queries, real-time
# - Query Language: APL (Axiom Processing Language)

# Grafana Loki:
# - Best for: Open-source, self-hosted, cost-conscious
# - Cost: $ (~$50/month self-hosted)
# - Features: Label-based indexing, Grafana integration
# - Query Language: LogQL

# ===================================
# Security Notes
# ===================================

# - Never commit API keys to git
# - Use different keys for dev/staging/prod
# - Rotate keys quarterly
# - Grant minimum required permissions
# - Monitor usage for anomalies

# ===================================
# Testing Your Setup
# ===================================

# Test Datadog:
# curl -X POST https://http-intake.logs.datadoghq.com/api/v2/logs \
#   -H "DD-API-KEY: $DATADOG_API_KEY" \
#   -H "Content-Type: application/json" \
#   -d '{"ddsource":"test","message":"Test log"}'

# Test Axiom:
# curl -X POST https://api.axiom.co/v1/datasets/$AXIOM_DATASET/ingest \
#   -H "Authorization: Bearer $AXIOM_TOKEN" \
#   -H "Content-Type: application/json" \
#   -d '[{"message":"Test log"}]'

# Test Loki:
# curl -X POST $LOKI_URL/loki/api/v1/push \
#   -H "Content-Type: application/json" \
#   -d '{"streams":[{"stream":{"job":"test"},"values":[["'$(date +%s%N)'","Test log"]]}]}'

# ===================================
# Troubleshooting
# ===================================

# Logs not appearing?
# 1. Check API keys are valid
# 2. Verify environment variables in Vercel dashboard
# 3. Check browser console for errors
# 4. Look for "Log drain initialized" message in logs
# 5. Test API endpoints manually (see Testing section above)

# Need help?
# - Datadog: https://docs.datadoghq.com/logs/
# - Axiom: https://axiom.co/docs/
# - Loki: https://grafana.com/docs/loki/
